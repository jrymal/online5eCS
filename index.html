<!DOCTYPE html>
<html lang="EN-US">
    <head>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <meta name="keywords" content="Character Sheet"/>
        <meta name="description" content="An online only Dungeons and Dragons 5th Edition character record sheet editor."/>
        <meta name="author" content="jrymal"/>
        <meta name="theme-color" content="#3367D6"/>

        <title>You have no Class!</title>

        <link rel="manifest" href="manifest.json">

        <link rel="icon" href="images/icons-192.png" sizes="192x192" />
        <link rel="icon" href="images/icons-512.png" sizes="512x512" />

        <script type="text/javascript" src="js/StaticUtil.js"> </script>
        <script type="text/javascript" src="js/Util.js" async> </script>
        <script type="text/javascript" src="js/DB.js" async> </script>
        <script type="text/javascript" src="js/Random.js" async> </script>
        <script type="text/javascript" src="js/Races.js" async> </script>
        <script type="text/javascript" src="js/Skills.js" async> </script>
        <script type="text/javascript" src="js/Classes.js" async> </script>
        <script type="text/javascript" src="js/Backstories.js" async> </script>
        <script type="text/javascript" src="js/Languages.js" async> </script>
        <script type="text/javascript" src="js/Coinage.js" async> </script>
        <script type="text/javascript" src="js/CharacterWizard.js" async> </script>
        <script type="text/javascript" src="js/Init.js" async> </script>
        <script type="text/javascript" src="js/Colors.js" async> </script>
        <script type="text/javascript" src="js/Dialogs.js" async> </script>

        <link rel="stylesheet" type="text/css" href="css/core.css" media="all" async/>

    </head>
    <body onload="init()" onbeforeunload="beforeUnload()" onhashchange="hashChange()">
        <noscript>
            <h1>This site requires Javascript</h1>
            <p>This site is a pure Javascript implementation of the Dungeons and Dragons 5th Edition Character generation. There are no plans to make it non-Javascript based at this time.</p>
        </noscript>
        <div id="rootNode" class="topContainer nocharacter">

            <section class="blankState">
                <h1>Online DnD Character Sheet</h2>
                <p>Please click on one of the links to begin creating your character.</p>
            </section>

            <nav class="nav nav-menu" role="navigation">
                <ul>
                    <li><a href="#createCharacter.player" onclick="return clearAllFields(document.getElementsByClassName('createCharacter')) && randomizeDataRNG();">Create a new Character</a></li>
                    <li><a href="#importFile">Load a character</a></li>
                    <li><a href="#" id="downloadCharacter">Download Character</a></li>
                    <li id="install-app" class="hidden"><a href="#" onClick="installApp()">Install as an App</a></li>
                </ul>
            </nav>

            <section class="stack header">
                <h1>
                    <span id="character.name.first"></span>
                    <span class="quoted" id="character.name.nickname"></span>
                    <span class="parens" id="character.name.child"></span>
                    <span id="character.name.family"></span>
                </h1>
            </section>
            
            <details class="stack playerInfo">
                <summary>Player: <span data-from="player.name"></span></summary>
                <dl>
                    <dt>Role Player</dt>
                    <dd><span data-from="player.name" contentEditable="true" data-placeholder="None specified"></span></dd>

                    <dt>Phone Number</dt>
                    <dd>
                    <span data-from="player.phone" id="player.phone.display" contentEditable="true" data-placeholder="None specified"></span>
                    <a target="_blank" id="player.phone.link" href="tel:+" data-show-always="true"></a>
                    </dd>

                    <dt>Email</dt>
                    <dd>
                    <span data-from="player.email" id="player.email.display" contentEditable="true" data-placeholder="None specified"></span>
                    <a target="_blank" id="player.email.link" href="mailto:" data-show-always="true"></a>
                    </dd>
                </dl>
            </details>
            
            <dl class="stack fullWidth subdivided stats">
                <dt>Race</dt>
                <dd>
                <span id="character.race" data-lookup="RACES"></span>
                </dd>

                <dt>Alignment</dt>
                <dd>Society: <span id="character.alignment.society"></span></dd>
                <dd>Morality: <span id="character.alignment.morality"></span></dd>
            
                <dt>Size</dt>
                <dd id="RACE.size.simple"></dd>

                <dt>Speed</dt>
                <dd id="RACE.speed"></dd>

                <dt>Class</dt>
                <dd class="marginless">
                    <table>
                        <caption>List of classes and levels</caption>
                        <thead>
                            <tr>
                                <th scope="col">Class</th>
                                <th scope="col">Level</th>
                                <th scope="col">Hit Die</th>
                            </tr>
                        </thead>
                        <tbody id="character.class">
                        </tbody>
                    </table>
                    <a href="#levelUp">Level Up</a>
                </dd>

                <dt>Experience Points</dt>
                <dd id="character.experience" ></dd>

                <dt>Hit Points</dt>
                <dd>
                    <!-- meter might be a better tag for this--> 
                    <span id="character.hitPoints.current"></span>/<span id="character.hitPoints.max"></span>
                </dd>

                <dt>Race Traits</dt>
                <dd id="RACE.features"></dd>

                <dt>Class Features</dt>
                <dd id="CALC.class.features"></dd>
                <dd id="CALC.class.special"></dd>

                <dt class="spell-req">Spells</dt>
                <dd class="spell-req" id="RACE.spells"></dd>
                <dd class="spell-req" id="character.spells"></dd>

                <dt>Saving Throw Bonus</dt>
                <dd id="CALC.savingThrows"></dd> 

                <dt>Proficiencies</dt>
                <dd id="CALC.proficiency"></dd>

                <dt>Skills</dt>
                <dd class="marginless">
                <table>
                    <caption>List of skills</caption>
                    <thead>
                        <tr>
                            <th scope="col">Name</th>
                            <th scope="col">Bonus</th>
                        </tr>
                    </thead>
                    <tbody id="character.skills">
                    </tbody>
                </table>
                </dd>
            
                <dt>Languages</dt>
                <dd id="character.languages" data-lookup="LANGUAGES"></dd>

                <dt>Inspiration</dt>
                <dd><label><input type="checkbox" id="character.inspiration" disabled="disabled"/>Inspiration</label</dd>
            </dl>

            <table class="stack fullWidth attributes">
                <caption>Your character's Attribute values</caption>
                <thead>
                    <tr>
                        <th scope="col">Attribute Name</th>
                        <th scope="col">Natural (Race Modifier)</th>
                        <th scope="col">Total</th>
                        <th scope="col">Saving Throw Modifier</th>
                        <th scope="col">Passive Saving Throw</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <th scope="row">Strength</th>
                        <td >
                            <span id="character.attribute.strength"></span>
                            <span class="parens" id="CALC.attribute.strength.raceModifier" data-show-0="false"></span>
                        </td>
                        <td id="CALC.attribute.strength.total"></td>
                        <td>
                            <span id="CALC.attribute.strength.savingThrow"></span>
                            <span class="parens" id="CALC.attribute.strength.proficiencySavingThrow" data-show-0="false"></span>
                        </td>
                        <td id="CALC.attribute.strength.passiveSavingThrow"></td>
                    </tr>
                    <tr>
                        <th scope="row">Dexterity</th>
                        <td >
                            <span id="character.attribute.dexterity"></span>
                            <span class="parens"id="CALC.attribute.dexterity.raceModifier" data-show-0="false"></span>
                        </td>
                        <td id="CALC.attribute.dexterity.total"></td>
                        <td>
                            <span id="CALC.attribute.dexterity.savingThrow"></span>
                            <span class="parens" id="CALC.attribute.dexterity.proficiencySavingThrow" data-show-0="false"></span>
                        </td>
                        <td id="CALC.attribute.dexterity.passiveSavingThrow"></td>
                    </tr>  
                    <tr>
                        <th scope="row">Constitution</th>
                        <td >
                            <span id="character.attribute.constitution"></span>
                            <span class="parens"id="CALC.attribute.constitution.raceModifier" data-show-0="false"></span>
                        </td>
                        <td id="CALC.attribute.constitution.total"></td>
                        <td>
                            <span id="CALC.attribute.constitution.savingThrow"></span>
                            <span class="parens" id="CALC.attribute.constitution.proficiencySavingThrow" data-show-0="false"></span>
                        </td>
                        <td id="CALC.attribute.constitution.passiveSavingThrow"></td>
                    </tr>
                    <tr>
                        <th scope="row">Intelligence</th>
                        <td >
                            <span id="character.attribute.intelligence"></span>
                            <span class="parens"id="CALC.attribute.intelligence.raceModifier" data-show-0="false"></span>
                        </td>
                        <td id="CALC.attribute.intelligence.total"></td>
                        <td>
                            <span id="CALC.attribute.intelligence.savingThrow"></span>
                            <span class="parens" id="CALC.attribute.intelligence.proficiencySavingThrow" data-show-0="false"></span>
                        </td>
                        <td id="CALC.attribute.intelligence.passiveSavingThrow"></td>
                    </tr>
                    <tr>
                        <th scope="row">Wisdom</th>
                        <td >
                            <span id="character.attribute.wisdom"></span>
                            <span class="parens"id="CALC.attribute.wisdom.raceModifier" data-show-0="false"></span>
                        </td>
                        <td id="CALC.attribute.wisdom.total"></td>
                        <td>
                            <span id="CALC.attribute.wisdom.savingThrow"></span>
                            <span class="parens" id="CALC.attribute.wisdom.proficiencySavingThrow" data-show-0="false"></span>
                        </td>
                        <td id="CALC.attribute.wisdom.passiveSavingThrow"></td>
                    </tr>
                    <tr>
                        <th scope="row">Charisma</th>
                        <td >
                            <span id="character.attribute.charisma"></span>
                            <span class="parens"id="CALC.attribute.charisma.raceModifier" data-show-0="false"></span>
                        </td>
                        <td id="CALC.attribute.charisma.total"></td>
                        <td>
                            <span id="CALC.attribute.charisma.savingThrow"></span>
                            <span class="parens" id="CALC.attribute.charisma.proficiencySavingThrow" data-show-0="false"></span>
                        </td>
                        <td id="CALC.attribute.charisma.passiveSavingThrow"></td>
                    </tr>
                </tbody>
            </table>
            
            <dl class="stack fullWidth subdivided appearance">
                <dt>Sexuality</dt>
                <dd>Pronoun: <span id="character.sexuality.pronoun" data-lookup="PRONOUNS"></span></dd>
                <dd>Biological Sex: <span id="character.sexuality.biologicalsex"
                                                        data-lookup="BIOLOGICAL_SEX"></span></dd>
                <dd>Orientation: <span id="character.sexuality.sexualorientation" data-lookup="SEXUAL_ORIENTATION"></span>
                </dd>


                <dt>Age</dt>
                <dd id="character.details.age" ></dd>

                <dt>Height</dt>
                <dd id="character.details.height"></dd>

                <dt>Weight (in lbs)</dt>
                <dd id="character.details.weight"></dd>

                <dt>Purse</dt>
                <dd>
                <span id="character.purse"></span>
                <br/>
                <a href="#purseUpdate">Edit</a>
                </dd>
                
                <dt>Equipment</dt>
                <dd id="character.equipment"></dd>
                <dd><a href="#equipment">Edit</a></dd>


                <dt>Treasure</dt>
                <dd><span id="character.treasure" contentEditable="true" data-placeholder="None Expressed"></span></dd>

                <dt>Backstory Type</dt>
                <dd id="character.backstory.type" data-lookup="BACKSTORIES"></dd>
                
                <dt>Backstory</dt>
                <dd><span id="character.backstory.story" contentEditable="true" data-placeholder="None Expressed"></span></dd>

                <dt>Appearance</dt>
                <dd><span id="character.details.appearance" contentEditable="true" data-placeholder="None Expressed"></span></dd>
                
                <dd>Eye:
                    <div class="swatch tagAlong" id="character.details.eyecolor.color"></div>
                    <div class="tagAlong" id="character.details.eyecolor" data-lookup="EYE_COLOR"></div>
                </dd>
                <dd>Hair:
                    <div class="swatch tagAlong" id="character.details.hair.color"></div>
                    <div class="tagAlong" id="character.details.hair" data-lookup="HAIR_COLOR"></div>
                </dd>
                <dd>Skin:
                    <div class="swatch tagAlong" id="character.details.skin.color"></div>
                    <div class="tagAlong" id="character.details.skin" data-lookup="SKIN_COLOR"></div>
                </dd>


                <dt>Personality Traits</dt>
                <dd><span id="character.personalitytraits" contentEditable="true" data-placeholder="None Expressed"></span></dd>

                <dt>Ideals</dt>
                <dd><span id="character.ideals" contentEditable="true" data-placeholder="None Expressed"></span></dd>

                <dt>Bonds</dt>
                <dd><span id="character.bonds" contentEditable="true" data-placeholder="None Expressed"></span></dd>

                <dt>Flaws</dt>
                <dd><span id="character.flaws" contentEditable="true" data-placeholder="None Expressed"></span></dd>

                <dt>Allies</dt>
                <dd><span id="character.allies" contentEditable="true" data-placeholder="None Expressed"></span></dd>
            </dl>

            <footer class="footer">
                <p class="fullWidth footer"><i>I've been known to be wrong every once in a while. If you've found an Issue, <a rel="noopener" target="_blank" href="https://github.com/jrymal/online5eCS/issues/new">let me know!</a></i></p>
            </footer>

            <dialog class=" modal" id="importFile">
                <div class="base" >
                    <h2>Load Character</h2>
                    <p class="description">Load your character</p>
                    <div class="height100 scrollable">
                        <table>
                            <caption>Listing of Characters to load or delete</caption>
                            <thead>
                                <tr>
                                    <th scope="col">Player</th>
                                    <th scope="col">Character</th>
                                    <th scope="col">Race</th>
                                    <th scope="col">Class</th>
                                    <th scope="col">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="DB.character">
                            </tbody>
                        </table>
                    </div>
                    <br>
                    <div>
                    <label class="tagAlong" for="importFile.importFile">Import file</label>
                    <input class="tagAlong" type="file" id="importFile.importFile" name="importFile" onChange="loadFromJSON()"/>
                    </div>
                    <a href="#">Cancel</a>
                </div>
            </dialog>
            <dialog class=" modal" id="purseUpdate">
                <div class="base">
                    <h2>Purse</h2>
                    <p class="description">I assume you are buying or accumulating your wealth....otherwise, why are you here?</p>
                    <div class="height100 scrollable">
                    
                        <p class="stack">Current Purse: <span data-from="character.purse"></span></p>

                        <label for="purse.value">Amount</label>
                        <input class="tagAlong short" type="number" name="purse.value" pattern="[0-9]*" id="purse.value" min="0" value="0"/>
                        <select class="tagAlong" id="purse.type" name="purse.type" aria-label="Coin type for amount">
                            <option value="COPPER">Copper</option>
                            <option value="SILVER">Silver</option>
                            <option value="ELECTRUM">Electrum</option>
                            <option value="GOLD">Gold</option>
                            <option value="PLATINUM">Platinum</option>
                        </select>

                        <label for="purse.description" name="purse.description">Purchase Description</label>
                        <textarea id="purse.description" name="purse.description" spellcheck="true"></textarea>
                        <table>
                            <caption>Exchange Listing</caption>
                                <thead>
                                    <tr>
                                        <th scope="col">Coin</th>
                                        <th scope="col">Abbreviation</th>
                                        <th scope="col">Exchange</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <th scope="row">Platinum</th>
                                        <td>PP</td>
                                        <td>1 PP = 100 SP</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">Gold</th>
                                        <td>GP</td>
                                        <td>1 GP = 10 SP</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">Electrum</th>
                                        <td>EP</td>
                                        <td>1 EP = 5 SP</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">Silver</th>
                                        <td>SP</td>
                                        <td>1 SP = ~1/2 day of labor</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">Copper</th>
                                        <td>CP</td>
                                        <td>10 CP = 1 SP</td>
                                    </tr>
                                </tbody>
                            </table>


                    </div>
                    <div class="buttonbar">
                        <button onClick="usePurse('-')">Spend</button>
                        <button onClick="usePurse('+')">Gain</button> 
                        <a href="#">Done</a>
                    </div>
                </div>
            </dialog>
            <dialog class=" modal" id="createCharacter.player">
                <div class="base">
                    <h2>Create a new character</h2>
                    <p class="description">Load your character</p>
                    <p class="description notice">Any data input here is kept exclusively on your machine and is not shared to any services or databases.</p>
                    <form class="data-createCharacter entryPanel createCharacter">
                        <label for="createCharacter.player.name" class="required">Role Player</label>
                        <input type="text" id="createCharacter.player.name" name="player.name" required/>

                        <label for="createCharacter.player.phone">Phone Number</label>
                        <input type="tel" id="createCharacter.player.phone" name="player.phone" autocomplete="tel"/>

                        <label for="createCharacter.player.email">Email</label>
                        <input type="email" id="createCharacter.player.email" name="player.email" autocomplete="email"/> 
                    </form>
                    <div class="buttonbar">
                        <a href="#">Cancel</a>
                        <a href="#" class="no-action">Previous</a>
                        <a href="#createCharacter.race" class="next">Next</a>
                    </div>
                </div>
            </dialog>
            <dialog class=" modal" id="createCharacter.race">
                <div class="base">
                    <h2>Create a new character</h2>
                    <p class="description">Load your character</p>
                    <form class="data-createCharacter entryPanel createCharacter">
                        <label for="createCharacter.character.race">Race</label>
                        <select id="createCharacter.character.race" name="character.race" data-lookup="RACES"></select>

                        <label for="createCharacter.character.pronoun">Pronoun</label>
                        <select id="createCharacter.character.pronoun" name="character.sexuality.pronoun" data-lookup="PRONOUNS"></select>
                        
                        <label for="createCharacter.character.biologicalsex">Biological Sex</label>
                        <select id="createCharacter.character.biologicalsex" name="character.sexuality.biologicalsex"
                            data-lookup="BIOLOGICAL_SEX"></select>

                        <label for="createCharacter.character.sexualorientation">Sexual Orientation</label>
                        <select id="createCharacter.character.sexualorientation" name="character.sexuality.sexualorientation"
                            data-lookup="SEXUAL_ORIENTATION"></select>

                    </form>
                    <div class="buttonbar">
                        <a href="#">Cancel</a>
                        <a href="#createCharacter.player" >Previous</a>
                        <a href="#createCharacter.alignment" class="next">Next</a>
                    </div>
                </div>
            </dialog>
            <dialog class=" modal" id="createCharacter.alignment">
                <div class="base">
                    <h2>Create a new character</h2>
                    <p class="description">Load your character</p>
                    <form class="data-createCharacter entryPanel createCharacter">
                        <label for="createCharacter.character.alignment.society">Alignment (Attitude toward Society)</label>
                        <select id="createCharacter.character.alignment.society" name="character.alignment.society" data-rng="true">
                            <option value="Lawful">Lawful</option>
                            <option value="Neutral">Neutral</option>
                            <option value="Chaotic">Chaotic</option>
                        </select>
                        <label for="createCharacter.character.alignment.morality">Alignment (Morality)</label>
                        <select id="createCharacter.character.alignment.morality" name="character.alignment.morality" data-rng="true">
                            <option value="Good">Good</option>
                            <option value="Neutral">Neutral</option>
                            <option value="Evil">Evil</option>
                        </select>  
                    </form>
                    <div class="buttonbar">
                        <a href="#">Cancel</a>
                        <a href="#createCharacter.race" >Previous</a>
                        <a href="#createCharacter.name" class="next">Next</a>
                    </div>
                </div>
            </dialog>
            <dialog class=" modal" id="createCharacter.name">
                <div class="base">
                    <h2>Create a new character</h2>
                    <p class="description">Load your character</p>
                    <form class="data-createCharacter entryPanel createCharacter">
                        <label for="createCharacter.character.name.first" class="required">First Name</label>
                        <input type="text" id="createCharacter.character.name.first" name="character.name.first" required/>
                        <label for="createCharacter.character.name.family">Family Name</label>
                        <input type="text" id="createCharacter.character.name.family" name="character.name.family"/>
                        <label for="createCharacter.character.name.nickname">Nickname</label>
                        <input type="text" id="createCharacter.character.name.nickname" name="character.name.nickname"/>
                        <label for="createCharacter.character.name.child">Child Name</label>
                        <input type="text" id="createCharacter.character.name.child" name="character.name.child"/>
                    </form>
                    <div class="buttonbar">
                        <a href="#">Cancel</a>
                        <a href="#createCharacter.race" >Previous</a>
                        <a href="#createCharacter.class" class="next">Next</a>
                    </div>
                </div>
            </dialog>
            <dialog class=" modal" id="createCharacter.class">
                <div class="base">
                    <h2>Create a new character</h2>
                    <p class="description">Load your character</p>
                    <form class="data-createCharacter entryPanel" id="createCharacter.class.form">
                        <div class="createCharacter">
                            <label for="createCharacter.character.class.type">Class</label>
                            <select id="createCharacter.character.class.type" data-lookup="CLASSES"></select>

                            <label for="createCharacter.character.level" class="required">Level</label>
                            <input type="number" id="createCharacter.character.level" pattern="[0-9]*" class="short" min="1" max="40" required value="1"/>

                            <button type="button" class="multiclass" onClick="addClass()">Add Class</button>
                        </div>
                        <table>
                            <caption>Classes choosen</caption>
                            <thead>
                                <tr>
                                    <th scope="col">Class</th>
                                    <th scope="col">Level</th>
                                    <th scope="col">Remove</th>
                                </tr>
                            </thead>
                            <tbody id="createCharacter.character.class.tbody">
                            </tbody> 
                        </table>
                    </form>
                    <div class="buttonbar">
                        <a href="#">Cancel</a>
                        <a href="#createCharacter.name" >Previous</a>
                        <a href="#createCharacter.attr" class="next"
                            onclick="return postProcessStep($('createCharacter.class.form'))">Next</a>
                    </div>
                </div>
            </dialog>
            <dialog class=" modal" id="createCharacter.attr">
                <div class="base">
                    <h2>Create a new character</h2>
                    <p class="description">Load your character</p>
                    <form class="data-createCharacter entryPanel">
                        <!-- generation options and execution -->
                        <label for="createCharacter.attr.chooser">How do you want your attributes set?</label>
                        <select id="createCharacter.attr.chooser">
                            <option value="Throwaway">Throwaway lowest of 4</option>
                            <option value="Straight">Straight 3 rolls</option>
                            <option value="Manual">I'll roll and enter the vaules</option>
                        </select>
                        <button type="button" onClick="generateAttributes()">Generate Attributes</button>

                        <div class="column-2 createCharacter">
                            <label for="createCharacter.character.attribute.strength" class="required">Strength</label>
                            <input type="number"  pattern="[0-9]*" name="character.attribute.strength" id="createCharacter.character.attribute.strength" class="short"  min="3" max="20" required/>
                            <label for="createCharacter.character.attribute.dexterity" class="required">Dexterity</label>
                            <input type="number"  pattern="[0-9]*" name="character.attribute.dexterity" id="createCharacter.character.attribute.dexterity" class="short"  min="3" max="20" required/>
                            <label for="createCharacter.character.attribute.constitution" class="required">Constitution</label>
                            <input type="number"  pattern="[0-9]*" name="character.attribute.constitution" id="createCharacter.character.attribute.constitution" class="short"  min="3" max="20" required/>
                            <label for="createCharacter.character.attribute.intelligence" class="required">Intelligence</label>
                            <input type="number"  pattern="[0-9]*" name="character.attribute.intelligence" id="createCharacter.character.attribute.intelligence" class="short"  min="3" max="20" required/>
                            <label for="createCharacter.character.attribute.wisdom" class="required">Wisdom</label>
                            <input type="number"  pattern="[0-9]*" name="character.attribute.wisdom" id="createCharacter.character.attribute.wisdom" class="short"  min="3" max="20" required/>
                            <label for="createCharacter.character.attribute.charisma" class="required">Charisma</label>
                            <input type="number"  pattern="[0-9]*" name="character.attribute.charisma" id="createCharacter.character.attribute.charisma" class="short"  min="3" max="20" required/>
                        </div>
                    </form>
                    <div class="buttonbar">
                        <a href="#">Cancel</a>
                        <a href="#createCharacter.class" >Previous</a>
                        <a href="#createCharacter.backstory" class="next">Next</a>
                    </div>
                </div>
            </dialog>
            <dialog class=" modal" id="createCharacter.backstory">
                <div class="base">
                    <h2>Create a new character</h2>
                    <p class="description">Load your character</p>
                    <form class="data-createCharacter entryPanel createCharacter">
                        <label for="createCharacter.backstory.type">Backstory Type</label>
                        <select id="createCharacter.backstory.type" name="character.backstory.type"  data-lookup="BACKSTORIES"></select>

                        <label for="createCharacter.backstory.story">Backstory</label>
                        <textarea id="createCharacter.backstory.story" name="character.backstory.story" spellcheck="true"></textarea> 
                    </form>
                    <div class="buttonbar">
                        <a href="#">Cancel</a>
                        <a href="#createCharacter.attr" >Previous</a>
                        <a href="#createCharacter.age" class="next">Next</a>
                    </div>
                </div>
            </dialog>
            <dialog class=" modal" id="createCharacter.age">
                <div class="base">
                    <h2>Create a new character</h2>
                    <p class="description">Load your character</p>
                    <form class="data-createCharacter entryPanel createCharacter">
                        <label for="createCharacter.details.age">Age (in years)</label>
                        <input type="number" pattern="[0-9]*" id="createCharacter.details.age" class="short" name="character.details.age" min="0"max="100"/>

                        <label for="createCharacter.details.height">Height (in inches)</label>
                        <input type="text" id="createCharacter.details.height" name="character.details.height"/>

                        <label for="createCharacter.details.weight">Weight (in pounds)</label>
                        <input type="text" id="createCharacter.details.weight" name="character.details.weight"/>
                    </form>
                    <div class="buttonbar">
                        <a href="#">Cancel</a>
                        <a href="#createCharacter.backstory" >Previous</a>
                        <a href="#createCharacter.colors" class="next">Next</a>
                    </div>
                </div>
            </dialog>
            <dialog class=" modal" id="createCharacter.colors">
                <div class="base">
                    <h2>Create a new character</h2>
                    <p class="description">Load your character</p>
                    <form class="data-createCharacter entryPanel createCharacter">
                        <label for="createCharacter.details.eyecolor">Eye Color</label>
                        <select class="tagAlong"  id="createCharacter.details.eyecolor" name="character.details.eyecolor" data-type="color" data-lookup="EYE_COLOR" data-sort="false" onchange="changeColor(event);"></select>
                        <div id="createCharacter.details.eyecolor.color" class="swatch"></div>

                        <label for="createCharacter.details.skin">Skin Color</label>
                        <select class="tagAlong"  data-type="color" id="createCharacter.details.skin" name="character.details.skin" data-lookup="SKIN_COLOR" data-sort="false" onchange="changeColor(event);"></select>
                        <div id="createCharacter.details.skin.color" class="swatch"></div>

                        <label for="createCharacter.details.hair">Hair Color</label>
                        <select class="tagAlong" data-type="color" id="createCharacter.details.hair" name="character.details.hair" data-lookup="HAIR_COLOR" data-sort="false" onchange="changeColor(event);"></select>
                        <div id="createCharacter.details.hair.color" class="swatch"></div>
                    </form>
                    <div class="buttonbar">
                        <a href="#">Cancel</a>
                        <a href="#createCharacter.age" >Previous</a>
                        <a href="#createCharacter.appearance" class="next">Next</a>
                    </div>
                </div>
            </dialog>
            <dialog class=" modal" id="createCharacter.appearance">
                <div class="base">
                    <h2>Create a new character</h2>
                    <p class="description">Load your character</p>
                    <form class="data-createCharacter entryPanel createCharacter">
                        <label for="createCharacter.details.appearance">Appearance</label>
                        <textarea id="createCharacter.details.appearance" spellcheck="true" name="character.details.appearance"></textarea> 

                        <label for="createCharacter.details.image">Image</label>
                        <input type="image" id="createCharacter.details.image" name="character.details.image"/> 
                    </form>
                    <div class="buttonbar">
                        <a href="#">Cancel</a>
                        <a href="#createCharacter.colors" >Previous</a>
                        <a href="#createCharacter.skills" class="next">Next</a>
                    </div>
                </div>
            </dialog>
            <dialog class=" modal" id="createCharacter.skills">
                <div class="base">
                    <h2>Create a new character</h2>
                    <p class="description">Load your character</p>
                    <form class="data-createCharacter entryPanel createCharacter">
                        <fieldset>
                            <legend>Skills: choose <span id="createCharacter.skills.legend" data-rulemax="0"></span> more</legend>
                            <div name="character.skills" data-lookup="SKILLS"></div>
                        </fieldset>
                    </form>
                    <div class="buttonbar">
                        <a href="#">Cancel</a>
                        <a href="#createCharacter.appearance" >Previous</a>
                        <a href="#createCharacter.language" class="next">Next</a>
                    </div>
                </div>
            </dialog>
            <dialog class=" modal" id="createCharacter.language">
                <div class="base">
                    <h2>Create a new character</h2>
                    <p class="description">Load your character</p>
                    <form class="data-createCharacter entryPanel createCharacter" >
                        <fieldset>
                            <legend>Languages: choose <span id="createCharacter.languages.legend" data-rulemax="0"></span> more</legend>
                            <div name="character.languages" data-lookup="LANGUAGES"></div>
                        </fieldset>
                    </form>
                    <div class="buttonbar">
                        <a href="#">Cancel</a>
                        <a href="#createCharacter.skills" >Previous</a>
                        <a href="#createCharacter.traits" class="next">Next</a>
                    </div>
                </div>
            </dialog>
            <dialog class=" modal" id="createCharacter.traits">
                <div class="base">
                    <h2>Create a new character</h2>
                    <p class="description">Load your character</p>
                    <form class="data-createCharacter entryPanel createCharacter">
                    <!-- need to sure up the proficiencies editor: choose from list of
                        Proficiencies with free entry and stash.-->
                        <label for="createCharacter.proficiency">Proficiencies</label>
                        <textarea id="createCharacter.proficiency" name="character.proficiency" spellcheck="true"></textarea>
                    </form>
                    <div class="buttonbar">
                        <a href="#">Cancel</a>
                        <a href="#createCharacter.language" >Previous</a>
                        <a href="#createCharacter.equipment" class="next">Next</a>
                    </div>
                </div>
            </dialog>
            <dialog class="modal" id="createCharacter.equipment">
                <div class="base">
                    <h2>Create a new character</h2>
                    <p class="description">Load your character</p>
                    <form class="data-createCharacter entryPanel createCharacter" id="createCharacter.equipment.equipment"></form>
                    <div class="buttonbar">
                        <a href="#">Cancel</a>
                        <a href="#createCharacter.embellishments">Previous</a>
                        <a href="#" class="next" onClick="setCurrentCharacter(generateDataToJSON())">Complete</a>
                    </div>
                </div>
            </dialog>

            <dialog class="modal levelUp" id="levelUp">
                <div class="base">
                    <h2>Level Up</h2>
                    <p class="description">Raise your character's level</p>
                    <form class="entryPanel">
                        <input type="radio" class="tagAlong" name="levelUpType" id="levelUp.input.oldClass" value="levelUp.oldClass" onChange="setHref('levelUp.next','#levelUp.oldClass')" checked/>
                        <label for="levelUp.input.oldClass" class="tagAlong" >Raise a current class</label>
                        <label class="reveal-if-checked" for="levelUp.class">Class to level up</label>
                        <select class="reveal-if-checked" id="levelUp.class" data-lookup="currentCharacter.CALC.classes"></select>
                        <!-- Stupid tagAlong doesn't know when to break -->
                        <div></div>
                        <input type="radio" class="tagAlong" name="levelUpType" id="levelUp.input.newClass" value="levelUp.newClass" data-hrefid="levelUp.next"  onChange="setHref('levelUp.next','#levelUp.newClass')"/>
                        <label for="levelUp.input.newClass" class="tagAlong" >Add a new class</label>
                    </form>
                    <div class="buttonbar">
                        <a href="#">Cancel</a>
                        <a href="#levelUp.oldClass" class="next" id="levelUp.next">Next</a>
                    </div>
                </div>
            </dialog>
            <dialog class="modal levelUp" id="levelUp.oldClass">
                <div class="base">
                    <h2>Level Up</h2>
                    <p class="description">Raise your character's level by one</p>
                    <form class="entryPanel">
                        <dl>
                            <dt class="feature-req special-req">New Features</dt>
                            <dd class="feature-req" id="levelUp.feature"/>
                            <dd class="special-req" id="levelUp.special"/>
                            <dt class="spell-req">New Spells</dt>
                            <dd class="spell-req" id="levelUp.spell"/>
                            <dt class="ability-req">Ability Score Up</dt>
                            <dd class="ability-req">
                                <label for="levelUp.attribute">Ability to Improve</label>
                                <select id="levelUp.attribute" data-lookup="ATTRIBUTES"></select>
                            </dd>
                        </dl>
                    </form>
                    <div class="buttonbar">
                        <a href="#">Cancel</a>
                        <a href="#levelUp">Previous</a>
                        <a href="#" class="next" onClick="setCurrentCharacter(levelUp($('levelUp.class').value))">Level Up</a>
                    </div>
                </div>
            </dialog>
            <dialog class="modal multiClass" id="levelUp.newClass">
                <div class="base">
                    <h2>Level Up</h2>
                    <p class="description">Choose a new class to add to this character.</p>
                    <form class="entryPanel">
                        <label for="multiClass.class">New class to add</label>
                        <select id="multiClass.class" data-lookup="CLASSES"></select>
                    </form>
                    <div class="buttonbar">
                        <a href="#">Cancel</a>
                        <a href="#levelUp">Previous</a>
                        <a href="#" class="next" onClick="setCurrentCharacter(levelUpMultiClass())">Level Up</a>
                    </div>
                </div>
            </dialog>
            <dialog class="modal " id="equipment">
                <div class="base">
                    <h2>Equipment</h2>
                    <p class="description">Add or Use equipment in your pack</p>
                    <form class="entryPanel" >
                        <div id="equipment.list">
                        </div>
                        <button type="button" onClick="addEquipmentRow('equipment.list')">Add Item</button>
                    </form>
                    <div class="buttonbar">
                        <a href="#">Cancel</a>
                        <a href="#" class="next" onClick="setCurrentCharacter(updateEquipment('equipment.list', currentCharacter))">Complete</a>
                    </div>
                </div>
            </dialog>
            <dialog class="modal" id="editor">
                <form method="dialog" class="base">
                    <h2 id="editor.title">Editor</h2>
                    <p class="description" id="editor.description">Edit your stuff</p>
                    <div class="entryPanel columned" >
                        <label id="editor.field" for="editor.textarea">Edit field</label>
                        <textarea id="editor.textarea" spellcheck="true"></textarea>
                    </div>
                    <menu class="buttonbar">
                        <button onClick="closeDialog()">Cancel</button>
                        <button class="next" onClick="setCurrentCharacter(updateFromEditor(currentCharacter))">Complete</button>
                    </menu>
                </form>
            </dialog>


        <!-- Root Node Closing -->
        </div>
        
        <script>
            'use strict';
            if('serviceWorker' in navigator) {
                navigator.serviceWorker
                    .register('online5eCS-serviceworker.js')
                    .then(function() { console.log("Service Worker Registered"); })
                    .catch(function(error) {console.warn('Registration failed with ' + error);});
            }
        </script>

    </body>
</html>
